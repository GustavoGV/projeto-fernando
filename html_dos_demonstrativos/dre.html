<html>
    <head>
        <meta charset="utf-8">
        <title></title>

        <style>
            table, td, th {
            
                border: 1px solid black;
                padding: 2px;

            }
            table {
                border-collapse: collapse;
                width: 80%;
            }
            th {
                height: 25px;
            }



           </style>
           <table id="myTable">
            <tr>
                <td>TIPO DE SERVIÇO</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>147</td>
                <td></td>
            </tr>
            <tr>
                <th>FATURAMENTO TOTAL</th>
                <td></td>
                <td></td>
                <td></td>
                <td>100%</td>
                <td></td>
                <td>$ Preço Médio</td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td># Atendimentos</td>
                <td></td>
            </tr>
            <tr>
                <th>(-) CUSTOS SERVIÇOS PRESTADOS (CSP)</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Custo 147</td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Custo 157</td>
                <td></td>
            </tr>
            <tr>
                <td>CAPACIDADE INSTALADA INICIAL DE </BR> PRESTAÇÃO DE SERVIÇO</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td># Estoque Inicial</td>
                <td></td>
            </tr>
            <tr>
                <td>CUSTO DE PRESTAÇÃO DOS SERVIÇOS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>CUSTO DE CAPACIDADE INSTALADA NÃO</BR>UTILIZADA PARA A PRESTAÇÃO DE SERVIÇOS</BR>($ 36 / unit.)</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td># Total não</br> utilizado</td>
                <td></td>
            </tr>
            <tr>
                <td>CUSTO DE ALTERAÇÃO DE TIPO DE SERVIÇO</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>ATENDIMENTO NA BASE DE HORA EXTRA</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>TOTAL EM DISPONIBILIDADE</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>(-) CAPACIDADE INSTALADA NÃO UTILIZADA</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td># Serviços não prestados</td>
                <td></td>
            </tr>
            <tr>
                <th>(-) CSP</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th>MARGEM BRUTA</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th>MARGEM BRUTA TOTAL</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th>TOTAL DE SERVIÇOS PRESTADOS</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th>(-) DESPESAS OPERACIONAIS</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>DESPESAS ADMINISTRATIVAS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Unitário</td>
                <td></td>
            </tr>
            <tr>
                <td>VENDEDORES / PROMOTORES</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td># Promotores</td>
                <td></td>
            </tr>
            <tr>
                <td> - SALÁRIOS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>% Comissão</td>
                <td></td>
            </tr>
            <tr>
                <td> - COMISSÕES</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>$ Salário Unitário</td>
                <td>$ 2.160</td>
            </tr>
            <tr>
                <td>PROPAGANDA</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td> - INSTITUCIONAL</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td> - PRODUTOS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>DEPRECIAÇÃO DE MÁQUINAS & EQUIPAMENTOS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Período depreciação</br>máquinas (ANOS)</td>
                <td># 15</td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Valor unitário</td>
                <td></td>
            </tr>
            <tr>
                <td>ENCARGOS SOBRE FINANCIAMENTO</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Taxa de juros</td>
                <td>8%</td>
            </tr>
            <tr>
                <td>TRANSPORTE</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td># Motorista</td>
                <td></td>
            </tr>
            <tr>
                <td> - SALÁRIOS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Salários Unitário</td>
                <td>$ 4.800</td>
            </tr>
            <tr>
                <td> - LUBRIFICAÇÃO E MANUTENÇÃO</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Manutenção</td>
                <td>$ 6000</td>
            </tr>
            <tr>
                <td> - DEPRECIAÇÃO DE VEÍCULOS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Valor de Veículo</td>
                <td>$ 57.600</td>
            </tr>
            <tr>
                <td> - FROTA DE TERCEIROS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Depreciação</br>(ANOS)</td>
                <td>4</td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Valor unitário</td>
                <td>$ 2.400</td>
            </tr>
            <tr>
                <td>DESPESAS NÃO PLANEJADAS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>POSTOS AVANÇADOS DE</BR>SERVIÇO (PAS)</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td># Postos</td>
                <td></td>
            </tr>
            <tr>
                <td>PESQUISAS DE MERCADO CONTRATADAS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Custo Unitário</td>
                <td>$ 2.160</td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>Custo Fixo</td>
                <td>$ 50.400</td>
            </tr>
            <tr>
                <td>TOTAL DESPESAS OPERACIONAIS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th>RESULTADOS ANTES DE CONSIDERAR OS TRIBUTOS</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>TRIBUTOS E TAXAS TOTAIS</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th style="color: green">RESULTADO DA OPERAÇÃO</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
          </table>
    

        
       
</div>
        
    </head>
    <body>
        <script>
            let dre = {
                            receita: 100000,
                            csp: 1000,
                            estoque_inicial: 2836,
                            custo_prestacao_servico: 300000,
                            custo_estocagem: 100000,
                            custo_troca_insumos: 100000,
                            hora_extra: 1000,
                            capacidade_n_utilizada: 10000,
                            margem_bruta: 100000,
                            despesas_administrativas: 30000,
                            salario_promotores: 30000,
                            comissao: 0.3,
                            propaganda_institucional: 100000,
                            propaganda_unitaria: 100000,
                            depreciacao_de_maquinas: 300000,
                            encargos_financiamento: 300000,
                            salario_frota: 300000,
                            manutencao_frota: 300000,
                            depreciacao_de_veiculos: 300000,
                            frota_terceirizada: 100000,
                            despesas_operacionais_n_planejadas: 300000,
                            pas: 1000000,
                            pesquisas: 10000030,
                            tributos: 1000002,
                            servicos: [['147',288],['158',324]], //
                            preco_medio: 500,
                            atendimentos: 400,
                            insumos_em_estoque: 985
                        }
            function update(d) {
                let table = document.getElementById("myTable");
                if(d.servicos.length == 1){
                table.rows[0].cells[6].innerHTML = 'Serviços: ' + d.servicos[0][0] + ' e ' + d.servicos[1][0]
                }
                else{
                table.rows[0].cells[6].innerHTML = 'Serviço ' + d.servicos[0][0]
                }
                table.rows[1].cells[3].innerHTML = d.receita
                table.rows[2].cells[7].innerHTML = d.atendimentos
                table.rows[3].cells[6].innerHTML = 'Custo ' + d.servicos[0][0]
                table.rows[3].cells[7].innerHTML = d.servicos[0][1]
                if(d.servicos.length == 2){
                    table.rows[4].cells[6].innerHTML = 'Custo ' + d.servicos[1][0]
                    table.rows[4].cells[7].innerHTML = d.servicos[1][1]
                }
                table.rows[5].cells[2].innerHTML = d.estoque_inicial
                table.rows[5].cells[7].innerHTML = d.estoque_inicial
                table.rows[6].cells[1].innerHTML = d.custo_prestacao_servico
                table.rows[7].cells[1].innerHTML = d.custo_estocagem
                table.rows[7].cells[7].innerHTML = d.custo_estocagem/36
                table.rows[8].cells[1].innerHTML = d.custo_troca_insumos
                table.rows[9].cells[1].innerHTML = d.hora_extra
                table.rows[9].cells[2].innerHTML = d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem
                table.rows[10].cells[2].innerHTML = d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial
                table.rows[11].cells[2].innerHTML = d.capacidade_n_utilizada
                table.rows[11].cells[7].innerHTML = d.insumos_em_estoque
                table.rows[12].cells[3].innerHTML = d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial - d.capacidade_n_utilizada
                table.rows[13].cells[3].innerHTML = d.receita - (d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial - d.capacidade_n_utilizada)
                table.rows[14].cells[3].innerHTML = d.receita - (d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial - d.capacidade_n_utilizada)
                table.rows[15].cells[5].innerHTML = d.atendimentos
                table.rows[17].cells[2].innerHTML = d.despesas_administrativas
                table.rows[17].cells[7].innerHTML = '???'
                table.rows[18].cells[7].innerHTML = d.salario_promotores/2160
                table.rows[19].cells[1].innerHTML = d.salario_promotores
                table.rows[19].cells[7].innerHTML = d.comissao
                table.rows[20].cells[1].innerHTML = d.comissao*d.receita
                table.rows[20].cells[2].innerHTML = d.comissao*d.receita + d.salario_promotores
                table.rows[22].cells[1].innerHTML = d.propaganda_institucional
                table.rows[23].cells[1].innerHTML = d.propaganda_unitaria
                table.rows[23].cells[2].innerHTML = d.propaganda_unitaria + d.propaganda_institucional
                table.rows[24].cells[2].innerHTML = d.depreciacao_de_maquinas
                table.rows[26].cells[2].innerHTML = d.encargos_financiamento
                table.rows[27].cells[7].innerHTML = d.salario_frota/4800
                table.rows[28].cells[1].innerHTML = d.salario_frota
                table.rows[29].cells[1].innerHTML = d.manutencao_frota
                table.rows[30].cells[1].innerHTML = d.depreciacao_de_veiculos
                table.rows[31].cells[1].innerHTML = d.frota_terceirizada
                table.rows[31].cells[2].innerHTML = d.salario_frota + d.frota_terceirizada + d.manutencao_frota + d.depreciacao_de_veiculos
                table.rows[33].cells[2].innerHTML = d.despesas_operacionais_n_planejadas
                table.rows[34].cells[2].innerHTML = d.pas
                table.rows[34].cells[7].innerHTML = d.pas/2160
                table.rows[35].cells[2].innerHTML = d.pesquisas
                table.rows[37].cells[3].innerHTML = d.despesas_administrativas + d.salario_promotores + d.comissao*d.receita + d.propaganda_institucional + d.propaganda_unitaria + d.depreciacao_de_maquinas + d.encargos_financiamento + d.salario_frota + d.manutencao_frota + d.depreciacao_de_veiculos + d.despesas_operacionais_n_planejadas + d.pas + d.pesquisas
                table.rows[38].cells[3].innerHTML = d.receita - (d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial - d.capacidade_n_utilizada) - (d.despesas_administrativas + d.salario_promotores + d.comissao*d.receita + d.propaganda_institucional + d.propaganda_unitaria + d.depreciacao_de_maquinas + d.encargos_financiamento + d.salario_frota + d.manutencao_frota + d.depreciacao_de_veiculos + d.despesas_operacionais_n_planejadas + d.pas + d.pesquisas)
                if((d.receita - (d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial - d.capacidade_n_utilizada) - (d.despesas_administrativas + d.salario_promotores + d.comissao*d.receita + d.propaganda_institucional + d.propaganda_unitaria + d.depreciacao_de_maquinas + d.encargos_financiamento + d.salario_frota + d.manutencao_frota + d.depreciacao_de_veiculos + d.despesas_operacionais_n_planejadas + d.pas + d.pesquisas)) > 0){
                    table.rows[39].cells[3].innerHTML = (d.receita - (d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial - d.capacidade_n_utilizada) - (d.despesas_administrativas + d.salario_promotores + d.comissao*d.receita + d.propaganda_institucional + d.propaganda_unitaria + d.depreciacao_de_maquinas + d.encargos_financiamento + d.salario_frota + d.manutencao_frota + d.depreciacao_de_veiculos + d.despesas_operacionais_n_planejadas + d.pas + d.pesquisas))*0.3
                    table.rows[40].cells[3].innerHTML =  (d.receita - (d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial - d.capacidade_n_utilizada) - (d.despesas_administrativas + d.salario_promotores + d.comissao*d.receita + d.propaganda_institucional + d.propaganda_unitaria + d.depreciacao_de_maquinas + d.encargos_financiamento + d.salario_frota + d.manutencao_frota + d.depreciacao_de_veiculos + d.despesas_operacionais_n_planejadas + d.pas + d.pesquisas))*0.7
                }
                else{
                    table.rows[39].cells[3].innerHTML = 0
                    table.rows[40].cells[3].innerHTML = (d.receita - (d.custo_prestacao_servico + d.hora_extra + d.custo_troca_insumos + d.custo_estocagem + d.estoque_inicial - d.capacidade_n_utilizada) - (d.despesas_administrativas + d.salario_promotores + d.comissao*d.receita + d.propaganda_institucional + d.propaganda_unitaria + d.depreciacao_de_maquinas + d.encargos_financiamento + d.salario_frota + d.manutencao_frota + d.depreciacao_de_veiculos + d.despesas_operacionais_n_planejadas + d.pas + d.pesquisas))
                }
                
                //table.rows[28].cells[7].innerHTML = 
                table.rows[0].cells[0].style.backgroundColor = "gray"
                table.rows[17].cells[0].style.backgroundColor = "gray"
                table.rows[18].cells[0].style.backgroundColor = "gray"
                table.rows[21].cells[0].style.backgroundColor = "gray"
                table.rows[24].cells[0].style.backgroundColor = "gray"
                table.rows[26].cells[0].style.backgroundColor = "gray"
                table.rows[27].cells[0].style.backgroundColor = "gray"
                table.rows[33].cells[0].style.backgroundColor = "gray"
                table.rows[34].cells[0].style.backgroundColor = "gray"
                table.rows[35].cells[0].style.backgroundColor = "gray"
                table.rows[37].cells[0].style.backgroundColor = "gray"
                table.rows[39].cells[0].style.backgroundColor = "gray"
            }
            update(dre)
        </script>
    </body>
</html>